"""Used to log to a flight log.

This service is hosted by a logger instance and is responsible
for writing all system logs to an MCAP file for mission playback.

Attributes:
    STUB (flight_log_service_pb2_grpc.FlightLogStub): stub that is automatically set at runtime so that actions
        for this service can connect to gRPC
"""

###############################################################
# NOTE: THIS FILE IS GENERATED BY GENERATE_API.PY. DO NOT EDIT!
###############################################################
from typing import Optional, List
from google.protobuf.timestamp_pb2 import Timestamp
from google.protobuf.duration_pb2 import Duration
from google.protobuf.json_format import ParseDict
from enum import Enum
# API imports
from ...base import Action, Datatype
from ....dsl.compiler.registry import register_action
from ..native import run_unary, run_streaming, payload_from_action
# Protobuf imports
from ....protocol.services import flight_log_service_pb2
from ....protocol.services import flight_log_service_pb2_grpc
# Type imports
from ...datatypes.common import Response
from ...datatypes import flightlog as params
from ...datatypes import common as common

STUB: flight_log_service_pb2_grpc.FlightLogStub = None

@register_action
class Log(Action):
    """Basic log endpoint.

    Behaves identically to most log endpoints, but writes the data to
    an MCAP file instead of the console.

    Attributes:
        topic (str): topic of the log
        log (params.LogMessage): log content
    """
    topic: str
    log: params.LogMessage

    async def execute(self) -> Response:
        """Execute the Log action.

        Returns:
            Response: response generated by the RPC call.
        """
        req = flight_log_service_pb2.LogRequest()
        ParseDict(payload_from_action(self), req)
        return await run_unary(STUB.Log, req)

@register_action
class LogProto(Action):
    """Protobuf log endpoint.

    Accepts Protobuf Request/Response types, and writes the data to
    an MCAP file. Useful for playback of gRPC calls.

    Attributes:
        topic (str): topic of the log
        reqrep_proto (params.ReqRepProto): Request/Response object and content
    """
    topic: str
    reqrep_proto: params.ReqRepProto

    async def execute(self) -> Response:
        """Execute the LogProto action.

        Returns:
            Response: response generated by the RPC call.
        """
        req = flight_log_service_pb2.LogProtoRequest()
        ParseDict(payload_from_action(self), req)
        return await run_unary(STUB.LogProto, req)

